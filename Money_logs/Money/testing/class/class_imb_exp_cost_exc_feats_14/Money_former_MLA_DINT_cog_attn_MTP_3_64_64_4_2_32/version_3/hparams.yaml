args: !!python/object:argparse.Namespace
  architecture: Money_former_MLA_DINT_cog_attn_MTP
  aux_optimizer: adamw
  batch_size: 32
  bias: false
  class_weights:
  - - - 1.4218189716339111
      - 0.6886935830116272
      - 1.1839208602905273
    - - 1.2760354280471802
      - 0.7518360614776611
      - 1.1283555030822754
    - - 1.3116346597671509
      - 0.6880216598510742
      - 1.275266170501709
    - - 1.679100513458252
      - 0.5786834359169006
      - 1.478453278541565
    - - 1.0894267559051514
      - 0.9478793144226074
      - 0.9736155867576599
    - - 2.5769386291503906
      - 0.454298198223114
      - 2.4345991611480713
  - - - 1.6249359846115112
      - 0.5996787548065186
      - 1.3946385383605957
    - - 1.43143892288208
      - 0.6519774198532104
      - 1.3027504682540894
    - - 1.4763898849487305
      - 0.6044762134552002
      - 1.4962282180786133
    - - 2.0245614051818848
      - 0.5133867263793945
      - 1.7914197444915771
    - - 1.1845837831497192
      - 0.8013888597488403
      - 1.101336121559143
    - - 3.7313344478607178
      - 0.4070938229560852
      - 3.6289308071136475
  - - - 1.5253545045852661
      - 0.6463998556137085
      - 1.25409996509552
    - - 1.395558476448059
      - 0.6904917359352112
      - 1.1973212957382202
    - - 1.4722802639007568
      - 0.6118180155754089
      - 1.4570707082748413
    - - 1.953524112701416
      - 0.523291289806366
      - 1.7327327728271484
    - - 1.164373517036438
      - 0.8874440789222717
      - 0.9858651757240295
    - - 3.000945568084717
      - 0.42896729707717896
      - 2.9798121452331543
  - - - 1.3845986127853394
      - 0.7049872279167175
      - 1.1637330055236816
    - - 1.2555885314941406
      - 0.7599377632141113
      - 1.1265530586242676
    - - 1.3165318965911865
      - 0.6733503341674805
      - 1.3239465951919556
    - - 1.665879249572754
      - 0.5758482813835144
      - 1.5079591274261475
    - - 1.0844011306762695
      - 0.9581823945045471
      - 0.9669408798217773
    - - 2.6512112617492676
      - 0.4452160596847534
      - 2.6545379161834717
  - - - 0.6746386289596558
      - 5.495238304138184
      - 0.7486435770988464
    - - 0.6659322381019592
      - 5.495238304138184
      - 0.7596648931503296
    - - 0.6913943290710449
      - 5.481001853942871
      - 0.7292887568473816
    - - 0.6871278285980225
      - 5.438731670379639
      - 0.7348616123199463
    - - 0.6699388027191162
      - 5.5239338874816895
      - 0.7539795637130737
    - - 0.7340967059135437
      - 3.234964370727539
      - 0.7526384592056274
  classification_threshold: 0.01
  config: ./experiment_configs/MTP_classification_exp.json
  d_ff: 64
  d_model: 64
  dataset: Money
  down_up_loss_weight: 1.0
  dropout: 0.25
  dtype: fp32
  experiment_notes: normed feats, global sep, full attn cuz we cool like that, hand
    picked data, class imbalance weights, exp add cost from optim, using 0.5 vol in
    bollinger histogram
  extra_descriptor: ''
  flat_p_err_w: 1.5
  flat_t_err_w: 2.0
  folder_name: testing/class/class_imb_exp_cost_exc_feats_14
  global_exclude_close_vol: false
  global_exclude_clv: false
  global_exclude_ema: false
  global_exclude_ppo: false
  global_exclude_ret: false
  global_exclude_volume_vol: false
  global_exclude_vpt: false
  head_dim: 32
  include_sep_in_loss: false
  indices_to_predict:
  - 1
  - 2
  input_features: 169
  kv_compression_dim: 16
  local_exclude_clv: false
  local_exclude_ppo: false
  local_exclude_price: false
  local_exclude_price_bb: false
  local_exclude_price_ema: false
  local_exclude_price_vol: false
  local_exclude_ret: false
  local_exclude_ret_bb: false
  local_exclude_ret_ema: true
  local_exclude_ret_vol: false
  local_exclude_vpt: false
  lr: 0.001
  lr_mult: 0.5
  muon_lr: 0.005
  n_noisy_copies: 0
  nhead: 2
  noise_factor: 0.05
  normalization_means:
  - - 0.0011534657096490264
    - 0.001229618676006794
    - 0.00029751285910606384
    - 0.0004825037613045424
    - 0.0011807010741904378
    - 0.000220744070247747
  - - 0.001077315304428339
    - 0.001133570447564125
    - 0.00021996420400682837
    - 0.00043516576988622546
    - 0.001037873444147408
    - 0.00019159783551003784
  - - 0.0011420687660574913
    - 0.0011778203770518303
    - 0.00024933740496635437
    - 0.0004520693910308182
    - 0.001106046955101192
    - 0.0002125077007804066
  - - 0.0011757410829886794
    - 0.0012473745737224817
    - 0.0002900375984609127
    - 0.00047226870083250105
    - 0.0012212113942950964
    - 0.00021881841530557722
  - - -0.0811552032828331
    - -0.08921651542186737
    - -0.06981617212295532
    - -0.06988068670034409
    - -0.09225473552942276
    - -0.025690710172057152
  - - 0.08638962358236313
    - 0.19754549860954285
    - 0.012792443856596947
    - -0.16152019798755646
    - 0.39273005723953247
    - -0.5319851636886597
  - - 0.10426823794841766
    - 0.23533475399017334
    - 0.01777259074151516
    - -0.18423764407634735
    - 0.4576915204524994
    - -0.6319141387939453
  - - 0.11855597048997879
    - 0.27569127082824707
    - 0.012467111460864544
    - -0.19840480387210846
    - 0.5029385685920715
    - -0.7049115896224976
  - - 0.114361472427845
    - 0.3249741792678833
    - -0.019321415573358536
    - -0.2388940155506134
    - 0.5483503341674805
    - -0.8244569897651672
  - - 0.11253772675991058
    - 0.20511846244335175
    - 0.019296081736683846
    - 0.007089756429195404
    - 0.2650054097175598
    - -0.7208316922187805
  - - 0.12258096039295197
    - 0.26540330052375793
    - 0.0103888139128685
    - -0.011661344207823277
    - 0.3239061236381531
    - -0.9425238370895386
  - - 0.11854346841573715
    - 0.3331499397754669
    - -0.004135448019951582
    - -0.033862728625535965
    - 0.37480899691581726
    - -1.1750171184539795
  - - 0.10060013085603714
    - 0.39645910263061523
    - -0.03256693482398987
    - -0.09620014578104019
    - 0.4144814610481262
    - -1.5676456689834595
  - - 0.0011556863319128752
    - 0.0012295537162572145
    - 0.0002880183164961636
    - 0.00047909418935887516
    - 0.0011876150965690613
    - 0.00022171763703227043
  - - 0.0011492668418213725
    - 0.0012270617298781872
    - 0.00027224470977671444
    - 0.0004739675496239215
    - 0.0011933832429349422
    - 0.00022020672622602433
  - - 0.0011381672229617834
    - 0.0012247695121914148
    - 0.00024978091823868454
    - 0.0004654621588997543
    - 0.0011922409757971764
    - 0.00021662694052793086
  - - 0.0011169551871716976
    - 0.0012245691614225507
    - 0.0002164146426366642
    - 0.000452847481938079
    - 0.001177463447675109
    - 0.00021009892225265503
  - - 0.0010739034041762352
    - 0.0011291331611573696
    - 0.00020509975729510188
    - 0.00042871639016084373
    - 0.0010440050391480327
    - 0.00019192020408809185
  - - 0.0010677617974579334
    - 0.001125729875639081
    - 0.00018870754865929484
    - 0.0004240555572323501
    - 0.0010494471061974764
    - 0.00019037138554267585
  - - 0.0010574505431577563
    - 0.001123147550970316
    - 0.00016641701222397387
    - 0.00041651882929727435
    - 0.0010475998278707266
    - 0.0001868447579909116
  - - 0.0010380260646343231
    - 0.0011237162398174405
    - 0.00013384396152105182
    - 0.00040548969991505146
    - 0.0010324273025617003
    - 0.00018057147099170834
  - - 0.001133528770878911
    - 0.0011740181362256408
    - 0.0002399805816821754
    - 0.0004502194351516664
    - 0.001114750630222261
    - 0.00021143107733223587
  - - 0.0011251240503042936
    - 0.0011700654868036509
    - 0.0002244430797873065
    - 0.00044498220086097717
    - 0.001119700144045055
    - 0.00020952489285264164
  - - 0.0011127558536827564
    - 0.0011662711622193456
    - 0.00020153331570327282
    - 0.000435912748798728
    - 0.0011168195633217692
    - 0.000205570031539537
  - - 0.0010909767588600516
    - 0.0011642464669421315
    - 0.00016723352018743753
    - 0.0004224904696457088
    - 0.0010996694909408689
    - 0.00019858406449202448
  - - 0.0011663413606584072
    - 0.001238571247085929
    - 0.00027772109024226665
    - 0.00046774381189607084
    - 0.0012322989059612155
    - 0.00021712844318244606
  - - 0.0011591521324589849
    - 0.001234644092619419
    - 0.0002625808701850474
    - 0.0004628654569387436
    - 0.0012376155937090516
    - 0.0002149292704416439
  - - 0.0011483512353152037
    - 0.0012312571052461863
    - 0.0002405994600849226
    - 0.00045466693700291216
    - 0.0012344345450401306
    - 0.00021106457279529423
  - - 0.0011288722744211555
    - 0.0012301942333579063
    - 0.00020741819753311574
    - 0.0004428160027600825
    - 0.001216956996358931
    - 0.00020468313596211374
  - - 0.01624479703605175
    - 0.07378017157316208
    - -0.0017511508194729686
    - -0.007240318227559328
    - 0.09625943005084991
    - -0.1700330525636673
  - - 0.05567058548331261
    - 0.1597621589899063
    - 0.011246385984122753
    - -0.0038360387552529573
    - 0.19492124021053314
    - -0.34248384833335876
  - - 0.0648125559091568
    - 0.2234775871038437
    - -0.008328044787049294
    - -0.03557160496711731
    - 0.2728205919265747
    - -0.6306787729263306
  - - 0.08410361409187317
    - 0.3299710750579834
    - -0.018548114225268364
    - -0.07724203914403915
    - 0.39173197746276855
    - -1.1149049997329712
  - - -1130621440.0
    - 2055014656.0
    - -131938208.0
    - 40993960.0
    - 4281107200.0
    - 381882112.0
  - - -0.41913145780563354
    - 0.7215859889984131
    - -0.12072832137346268
    - -0.0272617619484663
    - 1.6109836101531982
    - -0.17165781557559967
  - - -3006513664.0
    - 990536384.0
    - -225137888.0
    - -49182704.0
    - 291330208.0
    - -1408615936.0
  - - -1512455168.0
    - 1370741632.0
    - -155411840.0
    - 39785888.0
    - 3778993152.0
    - -1048885440.0
  - - 0.0816899761557579
    - 0.08534543216228485
    - -0.08259512484073639
    - -0.04369305074214935
    - 0.08176779001951218
    - -0.08819831907749176
  - - 0.11456016451120377
    - 0.11242897808551788
    - -0.12416550517082214
    - -0.0663037970662117
    - 0.11599463224411011
    - -0.1245541125535965
  - - 0.09716293960809708
    - 0.09575656801462173
    - -0.11702609807252884
    - -0.06323511153459549
    - 0.09255325049161911
    - -0.11559368669986725
  - - 0.08277253061532974
    - 0.08376212418079376
    - -0.08538135141134262
    - -0.04268678277730942
    - 0.07683508098125458
    - -0.086146779358387
  - - 0.11834842711687088
    - 0.11380086094141006
    - -0.12668846547603607
    - -0.06482116878032684
    - 0.1140345111489296
    - -0.12310972809791565
  - - 0.09955288469791412
    - 0.09571915119886398
    - -0.11874805390834808
    - -0.061291858553886414
    - 0.08914025127887726
    - -0.11294060200452805
  - - 0.07986272126436234
    - 0.0869046077132225
    - -0.08446556329727173
    - -0.04794105142354965
    - 0.08749839663505554
    - -0.09324999153614044
  - - 0.1126522347331047
    - 0.11310821026563644
    - -0.12432817369699478
    - -0.06878620386123657
    - 0.11993687599897385
    - -0.12726689875125885
  - - 0.09584522992372513
    - 0.09716757386922836
    - -0.11733657866716385
    - -0.06608506292104721
    - 0.09816159307956696
    - -0.11902245134115219
  - - 0.08413099497556686
    - 0.08819835633039474
    - -0.08189979195594788
    - -0.042747486382722855
    - 0.08725578337907791
    - -0.08742383122444153
  - - 0.11638794839382172
    - 0.11348956823348999
    - -0.12469493597745895
    - -0.06602412462234497
    - 0.11799821257591248
    - -0.12433189898729324
  - - 0.09822477400302887
    - 0.09643833339214325
    - -0.11897704750299454
    - -0.06447463482618332
    - 0.09515368938446045
    - -0.11722194403409958
  - - -0.009838122874498367
    - -0.012448413297533989
    - -0.008025208488106728
    - -0.007841660641133785
    - -0.010610787197947502
    - -0.00138480041641742
  - - -0.009372111409902573
    - -0.011280872859060764
    - -0.007106310222297907
    - -0.00723961740732193
    - -0.008292564190924168
    - -0.00039159972220659256
  - - -0.06286271661520004
    - -0.10800395905971527
    - -0.01897154003381729
    - -0.019956015050411224
    - -0.07108414173126221
    - 0.11047795414924622
  - - 0.04100736975669861
    - 0.04868515580892563
    - 0.01186362374573946
    - 0.01866285875439644
    - 0.01212350558489561
    - 0.10431748628616333
  normalization_stds:
  - - 0.024002019315958023
    - 0.03098125569522381
    - 0.02195555530488491
    - 0.018096813932061195
    - 0.035426873713731766
    - 0.011628526262938976
  - - 0.020967155694961548
    - 0.0277729369699955
    - 0.01812896691262722
    - 0.015360590070486069
    - 0.031201496720314026
    - 0.008828267455101013
  - - 0.02289552055299282
    - 0.028552966192364693
    - 0.01956399530172348
    - 0.01627209223806858
    - 0.03292055055499077
    - 0.010567388497292995
  - - 0.024769006296992302
    - 0.031073907390236855
    - 0.021715186536312103
    - 0.017516199499368668
    - 0.03647954761981964
    - 0.011163062416017056
  - - 0.9514077305793762
    - 1.026073694229126
    - 0.909271240234375
    - 0.8878679871559143
    - 1.0559313297271729
    - 0.5108284950256348
  - - 0.5524157881736755
    - 0.5932875275611877
    - 0.559708297252655
    - 0.5562053322792053
    - 0.5598209500312805
    - 0.5079445838928223
  - - 0.5333468317985535
    - 0.5982946753501892
    - 0.5394427180290222
    - 0.5514122247695923
    - 0.5312258005142212
    - 0.5163442492485046
  - - 0.5110309720039368
    - 0.5946377515792847
    - 0.5262259840965271
    - 0.5372776985168457
    - 0.5141711235046387
    - 0.5155313014984131
  - - 0.508169949054718
    - 0.5808467268943787
    - 0.5366882681846619
    - 0.5304014086723328
    - 0.5198256969451904
    - 0.5258894562721252
  - - 0.5938864946365356
    - 0.6138777732849121
    - 0.5932210087776184
    - 0.5863791108131409
    - 0.5861472487449646
    - 0.5532276630401611
  - - 0.5966925621032715
    - 0.6133949160575867
    - 0.6015640497207642
    - 0.5865854024887085
    - 0.5564462542533875
    - 0.6018919348716736
  - - 0.6263095140457153
    - 0.6079848408699036
    - 0.6685304045677185
    - 0.5852364301681519
    - 0.5208341479301453
    - 0.651473343372345
  - - 0.689262330532074
    - 0.5953606963157654
    - 0.824483335018158
    - 0.5945119261741638
    - 0.48517969250679016
    - 0.7099226117134094
  - - 0.010608133859932423
    - 0.013592617586255074
    - 0.009273002855479717
    - 0.0076155043207108974
    - 0.01579262688755989
    - 0.004781888332217932
  - - 0.0075866770930588245
    - 0.009413007646799088
    - 0.006388124078512192
    - 0.005189660936594009
    - 0.011155961081385612
    - 0.0032499548979103565
  - - 0.005500040017068386
    - 0.006453821901232004
    - 0.004450024571269751
    - 0.00353267602622509
    - 0.007938708178699017
    - 0.0022215680219233036
  - - 0.003669584169983864
    - 0.003939769696444273
    - 0.002783339936286211
    - 0.0020717710722237825
    - 0.005131001118570566
    - 0.0013602968538179994
  - - 0.01007403340190649
    - 0.01293343398720026
    - 0.008413329720497131
    - 0.006984194740653038
    - 0.014939958229660988
    - 0.0041475240141153336
  - - 0.007394250016659498
    - 0.009093724191188812
    - 0.005977196153253317
    - 0.004883115645498037
    - 0.010760655626654625
    - 0.002933555282652378
  - - 0.005464343819767237
    - 0.006316512823104858
    - 0.004267929121851921
    - 0.0033906036987900734
    - 0.007764238864183426
    - 0.00207207421772182
  - - 0.0037075618747621775
    - 0.003911072388291359
    - 0.002743346383795142
    - 0.0020284391939640045
    - 0.005090072751045227
    - 0.0013171500759199262
  - - 0.010677225887775421
    - 0.013329330831766129
    - 0.00899619422852993
    - 0.007411792408674955
    - 0.015601497143507004
    - 0.004860414657741785
  - - 0.00770243164151907
    - 0.009346777573227882
    - 0.006335316691547632
    - 0.0051555391401052475
    - 0.011145482771098614
    - 0.003367063356563449
  - - 0.005603161174803972
    - 0.006451041903346777
    - 0.004478474147617817
    - 0.003556063398718834
    - 0.007973503321409225
    - 0.0023202879820019007
  - - 0.0037383725866675377
    - 0.003953529056161642
    - 0.0028352588415145874
    - 0.0021055699326097965
    - 0.005173535086214542
    - 0.001421718974597752
  - - 0.010697913356125355
    - 0.013338628225028515
    - 0.009101456962525845
    - 0.0074335262179374695
    - 0.015843888744711876
    - 0.004709985572844744
  - - 0.007659644819796085
    - 0.009256958961486816
    - 0.006293941754847765
    - 0.005107895005494356
    - 0.0111608374863863
    - 0.003224326763302088
  - - 0.005566944368183613
    - 0.006360696628689766
    - 0.004409043118357658
    - 0.0035051903687417507
    - 0.00792963057756424
    - 0.0022148422431200743
  - - 0.003715367056429386
    - 0.0038771063555032015
    - 0.002777737332507968
    - 0.002072261180728674
    - 0.005118950270116329
    - 0.0013619879027828574
  - - 0.8706802725791931
    - 0.9010326266288757
    - 0.8322900533676147
    - 0.7888173460960388
    - 0.9237779378890991
    - 0.5365270972251892
  - - 0.7744361162185669
    - 0.7857919931411743
    - 0.7528817057609558
    - 0.7125356793403625
    - 0.7897617220878601
    - 0.5199336409568787
  - - 0.6748709082603455
    - 0.653545081615448
    - 0.6615030765533447
    - 0.6254837512969971
    - 0.6256492733955383
    - 0.5009350776672363
  - - 0.6397429704666138
    - 0.5733031034469604
    - 0.6493260264396667
    - 0.5442786812782288
    - 0.5062605142593384
    - 0.46781304478645325
  - - 1488644992.0
    - 924935040.0
    - 26831258.0
    - 20286868.0
    - 2063368448.0
    - 930785408.0
  - - 1.1030604839324951
    - 0.31899017095565796
    - 0.012005138210952282
    - 0.017776254564523697
    - 0.6889075636863708
    - 0.5022818446159363
  - - 628406464.0
    - 485327776.0
    - 66928620.0
    - 52871092.0
    - 828559808.0
    - 1034059328.0
  - - 1114755584.0
    - 614674368.0
    - 33558428.0
    - 19595548.0
    - 1888781952.0
    - 993514496.0
  - - 1.160526990890503
    - 1.3724980354309082
    - 0.9181576371192932
    - 0.7407337427139282
    - 1.6518949270248413
    - 0.4521487355232239
  - - 1.1657158136367798
    - 1.2861706018447876
    - 0.8844239711761475
    - 0.6925653219223022
    - 1.6349197626113892
    - 0.42385873198509216
  - - 1.1566715240478516
    - 1.3119016885757446
    - 0.8928539156913757
    - 0.7064357995986938
    - 1.634090542793274
    - 0.43292999267578125
  - - 1.174842119216919
    - 1.3804532289505005
    - 0.9104147553443909
    - 0.736086905002594
    - 1.6647177934646606
    - 0.4375515580177307
  - - 1.1868427991867065
    - 1.3033760786056519
    - 0.8876267075538635
    - 0.6951669454574585
    - 1.6554182767868042
    - 0.41769811511039734
  - - 1.1690394878387451
    - 1.319013237953186
    - 0.8878352642059326
    - 0.7028156518936157
    - 1.6428232192993164
    - 0.42182889580726624
  - - 1.1440688371658325
    - 1.3625913858413696
    - 0.9085078835487366
    - 0.7371764183044434
    - 1.6371252536773682
    - 0.4650031328201294
  - - 1.1485027074813843
    - 1.2815972566604614
    - 0.880302906036377
    - 0.6934554576873779
    - 1.6229437589645386
    - 0.43420353531837463
  - - 1.1387852430343628
    - 1.303888201713562
    - 0.8856969475746155
    - 0.7051802277565002
    - 1.6195299625396729
    - 0.4433700442314148
  - - 1.1467227935791016
    - 1.3550668954849243
    - 0.9060455560684204
    - 0.7334709763526917
    - 1.643240213394165
    - 0.45060253143310547
  - - 1.1616740226745605
    - 1.2835547924041748
    - 0.8820967674255371
    - 0.6917856335639954
    - 1.634535312652588
    - 0.4242253303527832
  - - 1.1540740728378296
    - 1.3089072704315186
    - 0.890675961971283
    - 0.7060761451721191
    - 1.6368523836135864
    - 0.43414223194122314
  - - 0.09065448492765427
    - 0.1018877774477005
    - 0.08181601762771606
    - 0.08123774826526642
    - 0.09841126203536987
    - 0.04522097483277321
  - - 0.08583806455135345
    - 0.0957019105553627
    - 0.0742153525352478
    - 0.07586965709924698
    - 0.08855503052473068
    - 0.041607629507780075
  - - 0.9150162935256958
    - 1.0048871040344238
    - 0.8203544616699219
    - 0.8173790574073792
    - 0.9711364507675171
    - 0.4791238307952881
  - - 0.6130905747413635
    - 0.6085864901542664
    - 0.6239792108535767
    - 0.6054476499557495
    - 0.6091197729110718
    - 0.6631107926368713
  num_classes: 3
  num_layers: 4
  num_params: 149968
  optimizer: adam
  prediction_type: classification
  q_compression_dim: 32
  qk_rope_dim: 16
  reload_data: false
  scheduler_type: cosine_restarts
  seed: 4
  seq_len: 3
  t_0: 4000
  t_mult: 1.5
  t_total: 5000
  tickers:
  - AAPL
  - AMZN
  - INTC
  - MSFT
  - NVDA
  - ^GSPC
  type: ''
  unique_inputs_ratio:
  - 0
  - 1
  up_down_err_w: 1.0
  use_global_seperator: true
  warmup_steps: 1000
  weight_decay: 0.0
batch_size: 32
learning_rate: 0.001
lr_mult: 0.5
t_0: 5000
t_mult: 1.5
warmup_steps: 1000
