args: !!python/object:argparse.Namespace
  architecture: Money_former_MLA_DINT_cog_attn_MTP
  aux_optimizer: adamw
  batch_size: 32
  bias: false
  class_weights:
  - - - 1.4218189716339111
      - 0.6886935830116272
      - 1.1839208602905273
    - - 1.2760354280471802
      - 0.7518360614776611
      - 1.1283555030822754
    - - 1.3116346597671509
      - 0.6880216598510742
      - 1.275266170501709
    - - 1.679100513458252
      - 0.5786834359169006
      - 1.478453278541565
    - - 2.5769386291503906
      - 0.454298198223114
      - 2.4345991611480713
  - - - 1.6249359846115112
      - 0.5996787548065186
      - 1.3946385383605957
    - - 1.43143892288208
      - 0.6519774198532104
      - 1.3027504682540894
    - - 1.4763898849487305
      - 0.6044762134552002
      - 1.4962282180786133
    - - 2.0245614051818848
      - 0.5133867263793945
      - 1.7914197444915771
    - - 3.7313344478607178
      - 0.4070938229560852
      - 3.6289308071136475
  - - - 1.5253545045852661
      - 0.6463998556137085
      - 1.25409996509552
    - - 1.395558476448059
      - 0.6904917359352112
      - 1.1973212957382202
    - - 1.4722802639007568
      - 0.6118180155754089
      - 1.4570707082748413
    - - 1.953524112701416
      - 0.523291289806366
      - 1.7327327728271484
    - - 3.000945568084717
      - 0.42896729707717896
      - 2.9798121452331543
  - - - 1.3845986127853394
      - 0.7049872279167175
      - 1.1637330055236816
    - - 1.2555885314941406
      - 0.7599377632141113
      - 1.1265530586242676
    - - 1.3165318965911865
      - 0.6733503341674805
      - 1.3239465951919556
    - - 1.665879249572754
      - 0.5758482813835144
      - 1.5079591274261475
    - - 2.6512112617492676
      - 0.4452160596847534
      - 2.6545379161834717
  - - - 0.6746386289596558
      - 5.495238304138184
      - 0.7486435770988464
    - - 0.6659322381019592
      - 5.495238304138184
      - 0.7596648931503296
    - - 0.6913943290710449
      - 5.481001853942871
      - 0.7292887568473816
    - - 0.6871278285980225
      - 5.438731670379639
      - 0.7348616123199463
    - - 0.7340967059135437
      - 3.234964370727539
      - 0.7526384592056274
  classification_threshold: 0.01
  config: ./experiment_configs/MTP_trade_loss_exp_base.json
  d_ff: 64
  d_model: 64
  dataset: Money
  down_up_loss_weight: 1.0
  dropout: 0.25
  dtype: fp32
  experiment_notes: global sep, hand picked data, no skew/kurtosis fixing, added MTP
    combined preds, trade loss - (transaction costs, exposure rebalance) causal, log
    util loss, removed nvda cuz it was too much of an outlier, trying hhi penalty
    - (forgot to normalize stock weights to sum to 1), trying to fix causality issue
    - changed G_vec mean dim attn, fixed view of outputs
  extra_descriptor: ''
  flat_p_err_w: 1.5
  flat_t_err_w: 2.0
  folder_name: testing/trade_loss/check_log_util_causal_seq_len_sweep/
  global_exclude_close_vol: false
  global_exclude_clv: false
  global_exclude_ema: false
  global_exclude_ppo: false
  global_exclude_ret: false
  global_exclude_volume_vol: false
  global_exclude_vpt: false
  head_dim: 32
  hhi_lambda: 0.0015
  include_sep_in_loss: false
  indices_to_predict:
  - 1
  - 2
  input_features: 63
  kv_compression_dim: 16
  local_exclude_clv: false
  local_exclude_ppo: false
  local_exclude_price: false
  local_exclude_price_bb: false
  local_exclude_price_ema: false
  local_exclude_price_vol: false
  local_exclude_ret: false
  local_exclude_ret_bb: false
  local_exclude_ret_ema: false
  local_exclude_ret_vol: false
  local_exclude_vpt: false
  lr: 0.00025
  lr_mult: 0.5
  muon_lr: 0.005
  n_noisy_copies: 0
  nhead: 2
  noise_factor: 0.05
  normalization_means:
  - - 0.0011534657096490264
    - 0.001229618676006794
    - 0.00029751285910606384
    - 0.0004825037613045424
    - 0.000220744070247747
  - - 0.001077315304428339
    - 0.001133570447564125
    - 0.00021996420400682837
    - 0.00043516576988622546
    - 0.00019159783551003784
  - - 0.0011420687660574913
    - 0.0011778203770518303
    - 0.00024933740496635437
    - 0.0004520693910308182
    - 0.0002125077007804066
  - - 0.0011757410829886794
    - 0.0012473745737224817
    - 0.0002900375984609127
    - 0.00047226870083250105
    - 0.00021881841530557722
  - - 0.06899788230657578
    - 0.08371672034263611
    - 0.07125453650951385
    - 0.0572567954659462
    - 0.017786627635359764
  - - 0.01944301463663578
    - 0.02358371764421463
    - 0.01802925392985344
    - 0.014774891547858715
    - 0.009382614865899086
  - - 0.020335620269179344
    - 0.024908987805247307
    - 0.0188524778932333
    - 0.015452542342245579
    - 0.009683127515017986
  - - 0.02096322737634182
    - 0.025917284190654755
    - 0.019294077530503273
    - 0.015871185809373856
    - 0.009844855405390263
  - - 0.021683955565094948
    - 0.02694607526063919
    - 0.019751159474253654
    - 0.01633193902671337
    - 0.01007493119686842
  - - 0.38692963123321533
    - 0.43131640553474426
    - 0.37717610597610474
    - 0.3444794714450836
    - 0.1685960739850998
  - - 0.40520238876342773
    - 0.4568597078323364
    - 0.4056842029094696
    - 0.36002296209335327
    - 0.17560385167598724
  - - 0.41869765520095825
    - 0.4766732156276703
    - 0.4356420934200287
    - 0.37236255407333374
    - 0.18310023844242096
  - - 0.4339858889579773
    - 0.4932760000228882
    - 0.4786991775035858
    - 0.3831769526004791
    - 0.1916717141866684
  - - 0.0011556863319128752
    - 0.0012295537162572145
    - 0.0002880183164961636
    - 0.00047909418935887516
    - 0.00022171763703227043
  - - 0.0011492668418213725
    - 0.0012270617298781872
    - 0.00027224470977671444
    - 0.0004739675496239215
    - 0.00022020672622602433
  - - 0.0011381672229617834
    - 0.0012247695121914148
    - 0.00024978091823868454
    - 0.0004654621588997543
    - 0.00021662694052793086
  - - 0.0011169551871716976
    - 0.0012245691614225507
    - 0.0002164146426366642
    - 0.000452847481938079
    - 0.00021009892225265503
  - - 0.0010739034041762352
    - 0.0011291331611573696
    - 0.00020509975729510188
    - 0.00042871639016084373
    - 0.00019192020408809185
  - - 0.0010677617974579334
    - 0.001125729875639081
    - 0.00018870754865929484
    - 0.0004240555572323501
    - 0.00019037138554267585
  - - 0.0010574505431577563
    - 0.001123147550970316
    - 0.00016641701222397387
    - 0.00041651882929727435
    - 0.0001868447579909116
  - - 0.0010380260646343231
    - 0.0011237162398174405
    - 0.00013384396152105182
    - 0.00040548969991505146
    - 0.00018057147099170834
  - - 0.001133528770878911
    - 0.0011740181362256408
    - 0.0002399805816821754
    - 0.0004502194351516664
    - 0.00021143107733223587
  - - 0.0011251240503042936
    - 0.0011700654868036509
    - 0.0002244430797873065
    - 0.00044498220086097717
    - 0.00020952489285264164
  - - 0.0011127558536827564
    - 0.0011662711622193456
    - 0.00020153331570327282
    - 0.000435912748798728
    - 0.000205570031539537
  - - 0.0010909767588600516
    - 0.0011642464669421315
    - 0.00016723352018743753
    - 0.0004224904696457088
    - 0.00019858406449202448
  - - 0.0011663413606584072
    - 0.001238571247085929
    - 0.00027772109024226665
    - 0.00046774381189607084
    - 0.00021712844318244606
  - - 0.0011591521324589849
    - 0.001234644092619419
    - 0.0002625808701850474
    - 0.0004628654569387436
    - 0.0002149292704416439
  - - 0.0011483512353152037
    - 0.0012312571052461863
    - 0.0002405994600849226
    - 0.00045466693700291216
    - 0.00021106457279529423
  - - 0.0011288722744211555
    - 0.0012301942333579063
    - 0.00020741819753311574
    - 0.0004428160027600825
    - 0.00020468313596211374
  - - 0.06920083612203598
    - 0.08371122181415558
    - 0.07130120694637299
    - 0.05724116414785385
    - 0.017798222601413727
  - - 0.06928523629903793
    - 0.0837353989481926
    - 0.07147783786058426
    - 0.05731629952788353
    - 0.017809364944696426
  - - 0.0693606361746788
    - 0.08377033472061157
    - 0.07171686738729477
    - 0.05739811062812805
    - 0.017824985086917877
  - - 0.06933986395597458
    - 0.08374399691820145
    - 0.07189840823411942
    - 0.0574101097881794
    - 0.01782061904668808
  - - -1130621440.0
    - 2055014656.0
    - -131938208.0
    - 40993960.0
    - 381882112.0
  - - -350189216.0
    - 2256999680.0
    - -104866344.0
    - 94566664.0
    - -104352408.0
  - - -3006513664.0
    - 990536384.0
    - -225137888.0
    - -49182704.0
    - -1408615936.0
  - - -1512455168.0
    - 1370741632.0
    - -155411840.0
    - 39785888.0
    - -1048885440.0
  - - 0.001800622558221221
    - 0.0015222851652652025
    - -0.00014314247528091073
    - 0.0006579988403245807
    - 0.0003354811924509704
  - - 0.003462200751528144
    - 0.0030748723074793816
    - -0.00044951096060685813
    - 0.0012712770840153098
    - 0.0006467250641435385
  - - 0.005653108935803175
    - 0.00501205725595355
    - -0.0003839688142761588
    - 0.002052455907687545
    - 0.001032389234751463
  - - 0.0018004185985773802
    - 0.0015240414068102837
    - -0.00014539955009240657
    - 0.0006558836903423071
    - 0.00033794547198340297
  - - 0.0034618377685546875
    - 0.0030657046008855104
    - -0.0004565622366499156
    - 0.0012688229326158762
    - 0.0006488977232947946
  - - 0.005638560745865107
    - 0.004988545551896095
    - -0.00040626240661367774
    - 0.0020408586133271456
    - 0.0010318949352949858
  - - 0.0018058866262435913
    - 0.0015258564380928874
    - -0.0001423709181835875
    - 0.0006595737067982554
    - 0.00033250474371016026
  - - 0.003473593620583415
    - 0.003070579841732979
    - -0.00045775488251820207
    - 0.0012681137304753065
    - 0.0006403296138159931
  - - 0.005676885601133108
    - 0.005025897175073624
    - -0.0003844171005766839
    - 0.002055464079603553
    - 0.0010283458977937698
  - - 0.0018084566108882427
    - 0.001528294524177909
    - -0.0001491382863605395
    - 0.0006569760735146701
    - 0.0003342765849083662
  - - 0.003479558043181896
    - 0.0030692170839756727
    - -0.00046875906991772354
    - 0.0012680230429396033
    - 0.0006441640434786677
  - - 0.0056714462116360664
    - 0.005009992513805628
    - -0.00041148517630063
    - 0.0020473271142691374
    - 0.0010286587057635188
  - - -0.009838122874498367
    - -0.012448413297533989
    - -0.008025208488106728
    - -0.007841660641133785
    - -0.00138480041641742
  - - -0.009372111409902573
    - -0.011280872859060764
    - -0.007106310222297907
    - -0.00723961740732193
    - -0.00039159972220659256
  - - -0.012899124063551426
    - -0.01585325598716736
    - -0.010202033445239067
    - -0.010086191818118095
    - -0.0002637332072481513
  - - 0.04100736975669861
    - 0.04868515580892563
    - 0.01186362374573946
    - 0.01866285875439644
    - 0.10431748628616333
  normalization_stds:
  - - 0.024002019315958023
    - 0.03098125569522381
    - 0.02195555530488491
    - 0.018096813932061195
    - 0.011628526262938976
  - - 0.020967155694961548
    - 0.0277729369699955
    - 0.01812896691262722
    - 0.015360590070486069
    - 0.008828267455101013
  - - 0.02289552055299282
    - 0.028552966192364693
    - 0.01956399530172348
    - 0.01627209223806858
    - 0.010567388497292995
  - - 0.024769006296992302
    - 0.031073907390236855
    - 0.021715186536312103
    - 0.017516199499368668
    - 0.011163062416017056
  - - 0.4760962128639221
    - 0.5283671021461487
    - 1.078454613685608
    - 0.40189826488494873
    - 0.20707759261131287
  - - 0.014387283474206924
    - 0.02035180851817131
    - 0.013150778599083424
    - 0.010966953821480274
    - 0.0072904909029603004
  - - 0.012873474508523941
    - 0.018683012574911118
    - 0.011939091607928276
    - 0.009856387041509151
    - 0.006739836651831865
  - - 0.011859040707349777
    - 0.017317913472652435
    - 0.011159470304846764
    - 0.008972540497779846
    - 0.0063646226190030575
  - - 0.011363532394170761
    - 0.015756359323859215
    - 0.01056186854839325
    - 0.00806445349007845
    - 0.005907044745981693
  - - 0.3175259232521057
    - 0.3480238616466522
    - 1.0223894119262695
    - 0.25045186281204224
    - 0.14183850586414337
  - - 0.27559682726860046
    - 0.29526853561401367
    - 1.0064811706542969
    - 0.20862145721912384
    - 0.12266717851161957
  - - 0.24200616776943207
    - 0.24724328517913818
    - 0.9916108250617981
    - 0.1719120591878891
    - 0.10481193661689758
  - - 0.2098332792520523
    - 0.20055577158927917
    - 0.9698421955108643
    - 0.13548526167869568
    - 0.08250319957733154
  - - 0.010608133859932423
    - 0.013592617586255074
    - 0.009273002855479717
    - 0.0076155043207108974
    - 0.004781888332217932
  - - 0.0075866770930588245
    - 0.009413007646799088
    - 0.006388124078512192
    - 0.005189660936594009
    - 0.0032499548979103565
  - - 0.005500040017068386
    - 0.006453821901232004
    - 0.004450024571269751
    - 0.00353267602622509
    - 0.0022215680219233036
  - - 0.003669584169983864
    - 0.003939769696444273
    - 0.002783339936286211
    - 0.0020717710722237825
    - 0.0013602968538179994
  - - 0.01007403340190649
    - 0.01293343398720026
    - 0.008413329720497131
    - 0.006984194740653038
    - 0.0041475240141153336
  - - 0.007394250016659498
    - 0.009093724191188812
    - 0.005977196153253317
    - 0.004883115645498037
    - 0.002933555282652378
  - - 0.005464343819767237
    - 0.006316512823104858
    - 0.004267929121851921
    - 0.0033906036987900734
    - 0.00207207421772182
  - - 0.0037075618747621775
    - 0.003911072388291359
    - 0.002743346383795142
    - 0.0020284391939640045
    - 0.0013171500759199262
  - - 0.010677225887775421
    - 0.013329330831766129
    - 0.00899619422852993
    - 0.007411792408674955
    - 0.004860414657741785
  - - 0.00770243164151907
    - 0.009346777573227882
    - 0.006335316691547632
    - 0.0051555391401052475
    - 0.003367063356563449
  - - 0.005603161174803972
    - 0.006451041903346777
    - 0.004478474147617817
    - 0.003556063398718834
    - 0.0023202879820019007
  - - 0.0037383725866675377
    - 0.003953529056161642
    - 0.0028352588415145874
    - 0.0021055699326097965
    - 0.001421718974597752
  - - 0.010697913356125355
    - 0.013338628225028515
    - 0.009101456962525845
    - 0.0074335262179374695
    - 0.004709985572844744
  - - 0.007659644819796085
    - 0.009256958961486816
    - 0.006293941754847765
    - 0.005107895005494356
    - 0.003224326763302088
  - - 0.005566944368183613
    - 0.006360696628689766
    - 0.004409043118357658
    - 0.0035051903687417507
    - 0.0022148422431200743
  - - 0.003715367056429386
    - 0.0038771063555032015
    - 0.002777737332507968
    - 0.002072261180728674
    - 0.0013619879027828574
  - - 0.1743485927581787
    - 0.19526351988315582
    - 0.46580180525779724
    - 0.13976183533668518
    - 0.07040233910083771
  - - 0.1122531071305275
    - 0.123851478099823
    - 0.3258233666419983
    - 0.08667489886283875
    - 0.04343687370419502
  - - 0.07477367669343948
    - 0.08040690422058105
    - 0.2296195775270462
    - 0.05459590628743172
    - 0.027040995657444
  - - 0.047019556164741516
    - 0.04962317273020744
    - 0.14910250902175903
    - 0.03147835657000542
    - 0.015141954645514488
  - - 1488644992.0
    - 924935040.0
    - 26831258.0
    - 20286868.0
    - 930785408.0
  - - 1770650240.0
    - 1012449088.0
    - 24867802.0
    - 38973892.0
    - 941697920.0
  - - 628406464.0
    - 485327776.0
    - 66928620.0
    - 52871092.0
    - 1034059328.0
  - - 1114755584.0
    - 614674368.0
    - 33558428.0
    - 19595548.0
    - 993514496.0
  - - 0.017445554956793785
    - 0.018918780609965324
    - 0.01316969096660614
    - 0.010374363511800766
    - 0.006552537437528372
  - - 0.02585640549659729
    - 0.02585514448583126
    - 0.018837790936231613
    - 0.014094005338847637
    - 0.009068322367966175
  - - 0.040573056787252426
    - 0.04278532415628433
    - 0.030491244047880173
    - 0.023412883281707764
    - 0.014917584136128426
  - - 0.017018431797623634
    - 0.018431177362799644
    - 0.012637072242796421
    - 0.009993049316108227
    - 0.0061233374290168285
  - - 0.02544110082089901
    - 0.025426512584090233
    - 0.018317708745598793
    - 0.013738217763602734
    - 0.008650205098092556
  - - 0.03988499194383621
    - 0.04197995737195015
    - 0.029543515294790268
    - 0.022737368941307068
    - 0.014139935374259949
  - - 0.0176440067589283
    - 0.01921844109892845
    - 0.013344781473279
    - 0.010536490008234978
    - 0.00692036421969533
  - - 0.026069318875670433
    - 0.026341089978814125
    - 0.01919255033135414
    - 0.014384132809937
    - 0.009521801955997944
  - - 0.04093250259757042
    - 0.0434911735355854
    - 0.030987238511443138
    - 0.023845890536904335
    - 0.0156827662140131
  - - 0.01723150722682476
    - 0.018773244693875313
    - 0.013018227182328701
    - 0.010295779444277287
    - 0.006548362784087658
  - - 0.025642940774559975
    - 0.02585022710263729
    - 0.018793266266584396
    - 0.014076918363571167
    - 0.009076429530978203
  - - 0.040263716131448746
    - 0.04263961315155029
    - 0.030329285189509392
    - 0.023328030481934547
    - 0.014922939240932465
  - - 0.09065448492765427
    - 0.1018877774477005
    - 0.08181601762771606
    - 0.08123774826526642
    - 0.04522097483277321
  - - 0.08583806455135345
    - 0.0957019105553627
    - 0.0742153525352478
    - 0.07586965709924698
    - 0.041607629507780075
  - - 0.17201383411884308
    - 0.19556671380996704
    - 0.15055236220359802
    - 0.15245412290096283
    - 0.08132117986679077
  - - 0.6130905747413635
    - 0.6085864901542664
    - 0.6239792108535767
    - 0.6054476499557495
    - 0.6631107926368713
  num_classes: 3
  num_layers: 4
  num_params: 142608
  optimizer: muon
  prediction_type: portfolio
  q_compression_dim: 32
  qk_rope_dim: 16
  reload_data: true
  scheduler_type: cosine_restarts
  seed: 1
  seq_len: 6
  t_0: 4000
  t_mult: 1.5
  t_total: 5000
  tickers:
  - AAPL
  - AMZN
  - INTC
  - MSFT
  - ^GSPC
  type: ''
  unique_inputs_ratio:
  - 0
  - 1
  up_down_err_w: 1.0
  use_global_seperator: true
  warmup_steps: 1000
  weight_decay: 0.0
batch_size: 32
learning_rate: 0.00025
lr_mult: 0.5
t_0: 5000
t_mult: 1.5
warmup_steps: 1000
